#include "Response.hpp"
# include <cstdio>

/* ************************************************************************** */
/* ---------------------------- STATIC VARIABLE ----------------------------- */
/* ************************************************************************** */

/* ************************************************************************** */
/* ------------------------------ CONSTRUCTOR ------------------------------- */
/* ************************************************************************** */

Response::Response() {}
Response::Response(ParsedRequest *request)
: _request(request)
{
}

/* ************************************************************************** */
/* ------------------------------- DESTRUCTOR ------------------------------- */
/* ************************************************************************** */

Response::~Response()
{
}

/* ************************************************************************** */
/* -------------------------------- OVERLOAD -------------------------------- */
/* ************************************************************************** */

Response& Response::operator=(const Response& obj)
{
	if (this == &obj)
		return (*this);
	return (*this);
}

/* ************************************************************************** */
/* --------------------------------- GETTER --------------------------------- */
/* ************************************************************************** */

std::string	Response::getResponse() {
	return (this->_response);
}

/* ************************************************************************** */
/* --------------------------------- SETTER --------------------------------- */
/* ************************************************************************** */

/* ************************************************************************** */
/* ------------------------------- EXCEPTION -------------------------------- */
/* ************************************************************************** */

/* ************************************************************************** */
/* ---------------------------- MEMBER FUNCTION ----------------------------- */
/* ************************************************************************** */

std::string	Response::runPut(ParsedRequest *request, int state) {
	ParsedRequest	*req = this->_request;
	FILE	*file = fopen(req->getConfigedPath().c_str(), "w");

	if (file != NULL)
	{
		fputs(this->_response.c_str(), file);
		std::cout << "♻️ put file update" << std::endl;
	}
	else
	{
		fputs(this->_response.c_str(), file);
		std::cout << "🔆 put file created" << std::endl;
	}
	if (state == 404)
		request->setStateCode(201);
	else
		request->setStateCode(200);
	// todo response200 return
	return this->_response;
}
