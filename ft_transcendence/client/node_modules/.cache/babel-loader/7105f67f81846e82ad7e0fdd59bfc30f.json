{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jinkim/bye_blackhole/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/jinkim/bye_blackhole/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/jinkim/bye_blackhole/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jinkim/bye_blackhole/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import\"./styles/ChatLog.scss\";import{findImg}from'../Images/Images';import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ChatLog=function ChatLog(_ref){var socket=_ref.socket,MyID=_ref.MyID,roomName=_ref.roomName;var _useState=useState([{userName:'jinkim',icon:'gamer_boy',msg:'hello',timeStamp:'2021-01-01 00:00'},{myMsg:'mymsgworlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf',timeStamp:'2021-01-01 00:00'},{sysMsg:'sysMsg님이 입장했습니다'},{userName:'2222',icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf',timeStamp:'2021-01-01 00:00'},{myMsg:'mymsg',timeStamp:'2021-01-01 00:00'},{myMsg:'mymsgworlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf',timeStamp:'2021-01-01 00:00'},{userName:'2222',icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf',timeStamp:'2021-01-01 00:00'},{userName:'2222',icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf',timeStamp:'2021-01-01 00:00'},{userName:'2222',icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf',timeStamp:'2021-01-01 00:00'},{userName:'2222',icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf',timeStamp:'2021-01-01 00:00'},{userName:'2222',icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf',timeStamp:'2021-01-01 00:00'},{userName:'2222',icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf',timeStamp:'2021-01-01 00:00'},{userName:'2222',icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf',timeStamp:'2021-01-01 00:00'},{userName:'2222',icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf',timeStamp:'2021-01-01 00:00'}]),_useState2=_slicedToArray(_useState,2),msgList=_useState2[0],setMsgList=_useState2[1];useEffect(function(){socket.on(\"onReceive\",/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(messageItem){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(MyID===messageItem.userName)setMsgList(function(msgList){return[].concat(_toConsumableArray(msgList),[{myMsg:messageItem.msg,timeStamp:messageItem.timeStamp}]);});else setMsgList(function(msgList){return[].concat(_toConsumableArray(msgList),[messageItem]);});_context.next=3;return axios.post('/chat/'+roomName,{id:messageItem.userName,timeStamp:messageItem.timeStamp,content:messageItem.msg});case 3:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());socket.on(\"onConnect\",/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(systemMessage){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setMsgList(function(msgList){return[].concat(_toConsumableArray(msgList),[{sysMsg:systemMessage}]);});_context2.next=3;return axios.post('/chat/'+roomName,{sysMsg:systemMessage});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref3.apply(this,arguments);};}());socket.on(\"onDisconnect\",/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(systemMessage){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setMsgList(function(msgList){return[].concat(_toConsumableArray(msgList),[{sysMsg:systemMessage}]);});_context3.next=3;return axios.post('/chat/'+roomName,{sysMsg:systemMessage});case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref4.apply(this,arguments);};}());return function(){socket.disconnect();};},[socket]);return/*#__PURE__*/_jsx(\"div\",{children:msgList.map(function(msg,idx){return/*#__PURE__*/_jsxs(\"div\",{children:[msg.msg&&/*#__PURE__*/_jsxs(\"div\",{className:\"msgLeft\",children:[/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"img\",{src:findImg(msg.icon),width:\"30\",height:\"30\",className:\"msg-icon\"})}),/*#__PURE__*/_jsxs(\"span\",{children:[msg.userName&&/*#__PURE__*/_jsx(\"div\",{className:\"msg-userName\",children:msg.userName}),/*#__PURE__*/_jsx(\"div\",{className:\"msg-left\",children:msg.msg})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"msg-timeStamp\",children:[\"(\",msg.timeStamp,\")\"]})]}),msg.myMsg&&/*#__PURE__*/_jsxs(\"div\",{className:\"msgRight\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"msg-right\",children:msg.myMsg}),/*#__PURE__*/_jsxs(\"span\",{className:\"msg-timeStamp\",children:[\"(\",msg.timeStamp,\")\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sysMsg\",children:msg.sysMsg})]},idx);})});};export default ChatLog;","map":{"version":3,"sources":["/Users/jinkim/bye_blackhole/client/src/Chat/ChatLog.tsx"],"names":["React","useEffect","useState","findImg","axios","ChatLog","socket","MyID","roomName","userName","icon","msg","timeStamp","myMsg","sysMsg","msgList","setMsgList","on","messageItem","post","id","content","systemMessage","disconnect","map","idx"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport \"./styles/ChatLog.scss\";\nimport {findImg} from '../Images/Images'\nimport axios from \"axios\";\n\nconst ChatLog = ({socket, MyID, roomName}: any) => {\n\tconst [msgList, setMsgList] = useState<any[]>([{userName:'jinkim', icon:'gamer_boy', msg:'hello', timeStamp:'2021-01-01 00:00'}, {myMsg:'mymsgworlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf', timeStamp:'2021-01-01 00:00'}, {sysMsg:'sysMsg님이 입장했습니다'},{userName:'2222', icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf', timeStamp:'2021-01-01 00:00'}, {myMsg:'mymsg', timeStamp:'2021-01-01 00:00'},{myMsg:'mymsgworlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf', timeStamp:'2021-01-01 00:00'}, {userName:'2222', icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf', timeStamp:'2021-01-01 00:00'}, {userName:'2222', icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf', timeStamp:'2021-01-01 00:00'}, {userName:'2222', icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf', timeStamp:'2021-01-01 00:00'}, {userName:'2222', icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf', timeStamp:'2021-01-01 00:00'}, {userName:'2222', icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf', timeStamp:'2021-01-01 00:00'}, {userName:'2222', icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf', timeStamp:'2021-01-01 00:00'}, {userName:'2222', icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf', timeStamp:'2021-01-01 00:00'}, {userName:'2222', icon:'gamer_girl',msg:'worlddddddddddddddddddddddddddddddddddddddasdfasdfasdfasdf', timeStamp:'2021-01-01 00:00'}]);\n\n\t\n\tuseEffect(() => {\n\n\t\tsocket.on(\"onReceive\", async(messageItem: {userName:string, msg:string, timeStamp:string}) => {\n\t\t\tif (MyID === messageItem.userName)\n\t\t\t\tsetMsgList((msgList) => [...msgList, {myMsg: messageItem.msg, timeStamp: messageItem.timeStamp} as never]);\n\t\t\telse\n\t\t\t\tsetMsgList((msgList) => [...msgList, messageItem]);\n\n\t\t\tawait axios.post('/chat/' + roomName, {id:messageItem.userName, timeStamp:messageItem.timeStamp, content:messageItem.msg})\n\t\t\t\n\t\t});\n\t\tsocket.on(\"onConnect\", async (systemMessage: string) => {\n\t\t\tsetMsgList((msgList) => [...msgList, { sysMsg: systemMessage } as never]);\n\t\t\t\n\t\t\tawait axios.post('/chat/' + roomName, {sysMsg: systemMessage})\n\t\t});\n\t\tsocket.on(\"onDisconnect\", async(systemMessage: any) => {\n\t\t\tsetMsgList((msgList) => [...msgList, { sysMsg: systemMessage } as never]);\n\n\t\t\tawait axios.post('/chat/' + roomName, {sysMsg: systemMessage})\n\t\t});\n\t\treturn () => {\n\t\t\tsocket.disconnect();\n\t\t};\n\t}, [socket]);\n\n\treturn (\n\t<div>\n\t\t{msgList.map((msg, idx) => (\n\t\t<div key={idx}>\n\t\t\t{msg.msg &&\n\t\t\t\t<div className=\"msgLeft\">\n\t\t\t\t\t<span><img src={findImg(msg.icon)}  width=\"30\" height=\"30\" className=\"msg-icon\"/></span>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{msg.userName && <div className=\"msg-userName\">{msg.userName}</div>}\n\t\t\t\t\t\t<div className=\"msg-left\">{msg.msg}</div>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span className=\"msg-timeStamp\">({msg.timeStamp})</span>\n\t\t\t\t</div>\n\t\t\t}\n\t\t\t{msg.myMsg &&\n\t\t\t\t<div className=\"msgRight\">\n\t\t\t\t\t<span className=\"msg-right\">{msg.myMsg}</span>\n\t\t\t\t\t<span className=\"msg-timeStamp\">({msg.timeStamp})</span>\n\t\t\t\t</div>\n\t\t\t}\n\t\t\t<div className=\"sysMsg\" >{msg.sysMsg}</div>\n\t\t</div>\n\t\t))}\n\t</div>\n\t);\n};\n\nexport default ChatLog;"]},"metadata":{},"sourceType":"module"}