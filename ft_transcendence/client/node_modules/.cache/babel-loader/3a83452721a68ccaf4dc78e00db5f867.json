{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jinkim/bye_blackhole/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jinkim/bye_blackhole/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jinkim/bye_blackhole/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import ChatInput from\"./ChatInput\";import ChatLog from\"./ChatLog\";import Loading from\"./Loading\";import UserList from\"./UserList\";import SideBar from\"../SideBar/SideBar\";import\"./styles/Chat.scss\";import setting from'../Images/setting.png';import ChatOwnerModal from\"./ChatOwnerModal\";import axios from\"axios\";import useSwr from'swr';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var socketIOClient=require('socket.io-client');var Chat=function Chat(){var _useState=useState(socketIOClient()),_useState2=_slicedToArray(_useState,2),currentSocket=_useState2[0],setCurrentSocket=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),MyID=_useState4[0],setMyID=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),MyIcon=_useState6[0],setMyIcon=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),roomName=_useState8[0],setRoomName=_useState8[1];var fetcher=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(url){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(roomName&&MyID)){_context.next=5;break;}_context.next=3;return axios.get(url);case 3:res=_context.sent;return _context.abrupt(\"return\",res.data);case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetcher(_x){return _ref.apply(this,arguments);};}();var _useSwr=useSwr('/Chat/info?title='+roomName+'&id='+MyID,fetcher),data=_useSwr.data,error=_useSwr.error;useEffect(function(){//setCurrentSocket(socketIOClient(\"http://localhost:8080\"));\nvar id=sessionStorage.getItem('nickname');var icon=sessionStorage.getItem('icon');var room=sessionStorage.getItem('roomName');if(id)setMyID(id);if(icon)setMyIcon(icon);if(room)setRoomName(room);});var myInfo={roomName:roomName,userName:MyID,icon:MyIcon};if(currentSocket){currentSocket.on(\"connect\",function(){currentSocket.emit(\"join\",myInfo);});}//chat owner modal\nvar _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),ChatOwnerModalState=_useState10[0],setChatOwnerModalState=_useState10[1];var openChatOwnerModal=function openChatOwnerModal(){setChatOwnerModalState(true);};var closeChatOwnerModal=function closeChatOwnerModal(){setChatOwnerModalState(false);};return/*#__PURE__*/_jsx(\"div\",{id:\"App-Container\",children:currentSocket?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"App-Left\",children:/*#__PURE__*/_jsxs(\"div\",{id:\"chat-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-top\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"RoomInfo-num\",children:data===null||data===void 0?void 0:data.num}),/*#__PURE__*/_jsx(\"span\",{children:roomName}),(data===null||data===void 0?void 0:data.myPermission)==='owner'?/*#__PURE__*/_jsx(\"button\",{className:\"setting-btn\",onClick:openChatOwnerModal,children:/*#__PURE__*/_jsx(\"img\",{src:setting,width:\"30\",height:\"30\"})}):null]}),/*#__PURE__*/_jsx(ChatOwnerModal,{open:ChatOwnerModalState,close:closeChatOwnerModal,chatRoomID:roomName}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-bottom\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"left-chatLog\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"chatLog-top\",children:/*#__PURE__*/_jsx(ChatLog,{socket:currentSocket,MyID:MyID,roomName:roomName})}),/*#__PURE__*/_jsx(\"div\",{className:\"chatLog-bottom\",children:/*#__PURE__*/_jsx(ChatInput,{socket:currentSocket})})]}),/*#__PURE__*/_jsx(\"span\",{className:\"right-chatUser\",children:/*#__PURE__*/_jsx(UserList,{socket:currentSocket})})]})]})}),/*#__PURE__*/_jsx(\"span\",{className:\"App-Right\",children:/*#__PURE__*/_jsx(SideBar,{})})]}):/*#__PURE__*/_jsx(Loading,{})});};export default Chat;","map":{"version":3,"sources":["/Users/jinkim/bye_blackhole/client/src/Chat/Chat.tsx"],"names":["React","useEffect","useState","ChatInput","ChatLog","Loading","UserList","SideBar","setting","ChatOwnerModal","axios","useSwr","socketIOClient","require","Chat","currentSocket","setCurrentSocket","MyID","setMyID","MyIcon","setMyIcon","roomName","setRoomName","fetcher","url","get","res","data","error","id","sessionStorage","getItem","icon","room","myInfo","userName","on","emit","ChatOwnerModalState","setChatOwnerModalState","openChatOwnerModal","closeChatOwnerModal","num","myPermission"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport ChatInput from \"./ChatInput\";\nimport ChatLog from \"./ChatLog\";\nimport Loading from \"./Loading\";\nimport UserList from \"./UserList\";\nimport SideBar from \"../SideBar/SideBar\";\nimport \"./styles/Chat.scss\"\nimport setting from '../Images/setting.png'\nimport ChatOwnerModal from \"./ChatOwnerModal\";\nimport axios from \"axios\";\nimport useSwr from 'swr';\nconst socketIOClient = require('socket.io-client')\n\nconst Chat = () => {\n\t\n\tconst [currentSocket, setCurrentSocket] = useState(socketIOClient());\n\tconst [MyID, setMyID] = useState('')\n\tconst [MyIcon, setMyIcon] = useState('')\n\tconst [roomName, setRoomName] = useState('')\n\n\tconst fetcher = async (url:string) => {\n\t\tif (roomName && MyID)\n\t\t{\n\t\t\tconst res = await axios.get(url)\n\t\t\treturn res.data;\n\t\t}\n\t}\n\tconst {data, error} = useSwr<{num:string, myPermission: string, security: string, users:{id:string, permission:string}[]}>('/Chat/info?title=' + roomName + '&id=' + MyID, fetcher)\n\n\tuseEffect(() => {\n\t\t//setCurrentSocket(socketIOClient(\"http://localhost:8080\"));\n\t\t\n\t\tconst id = sessionStorage.getItem('nickname')\n\t\tconst icon = sessionStorage.getItem('icon')\n\t\tconst room = sessionStorage.getItem('roomName')\n\t\tif (id) setMyID(id)\n\t\tif (icon) setMyIcon(icon)\n\t\tif (room) setRoomName(room)\n\t});\n\t\n\tconst myInfo = {\n\t\troomName: roomName,\n\t\tuserName: MyID,\n\t\ticon: MyIcon,\n\t};\n\n\tif (currentSocket) {\n\t\tcurrentSocket.on(\"connect\", () => {\n\t\t\tcurrentSocket.emit(\"join\", myInfo);\n\t\t});\n\t}\n\n\t\n\n\t//chat owner modal\n\tconst [ChatOwnerModalState, setChatOwnerModalState] = useState(false);\n\tconst openChatOwnerModal = () => {\n\t\tsetChatOwnerModalState(true);\n\t}\n\tconst closeChatOwnerModal = () => {\n\t\tsetChatOwnerModalState(false);\n\t}\n\n\treturn (\n\t<div id=\"App-Container\">\n\t\t{currentSocket ? (\n\t\t<>\n\t\t<span className=\"App-Left\">\n\t\t\t<div id=\"chat-container\">\n\t\t\t<div className=\"chat-top\">\n\t\t\t\t<span className=\"RoomInfo-num\">{data?.num}</span>\n\t\t\t\t<span>{roomName}</span>\n\t\t\t\t{data?.myPermission === 'owner' ? \n\t\t\t\t\t<button className=\"setting-btn\" onClick={openChatOwnerModal}>\n\t\t\t\t\t\t<img src={setting} width=\"30\" height=\"30\"></img>\n\t\t\t\t\t</button>\n\t\t\t\t\t: null\n\t\t\t\t}\n\t\t\t</div>\n\t\t\t<ChatOwnerModal open={ChatOwnerModalState} close={closeChatOwnerModal} chatRoomID={roomName}></ChatOwnerModal>\n\t\t\t<div className=\"chat-bottom\">\n\t\t\t\t<span className=\"left-chatLog\">\n\t\t\t\t\t<div className=\"chatLog-top\">\n\t\t\t\t\t\t<ChatLog socket={currentSocket} MyID={MyID} roomName={roomName}/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"chatLog-bottom\">\n\t\t\t\t\t\t<ChatInput socket={currentSocket}/>\n\t\t\t\t\t</div>\n\t\t\t\t</span>\n\t\t\t\t<span className=\"right-chatUser\">\n\t\t\t\t\t<UserList socket={currentSocket}></UserList>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t</div>\n\t\t</span>\n\t\t<span className=\"App-Right\">\n\t\t\t\t<SideBar />\n\t\t</span>\n\t\t</>\n\t\t) : (\n\t\t  <Loading></Loading>\n\t\t)}\n\t</div>\n  );\n};\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}