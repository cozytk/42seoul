{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/sayi/ft/base/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"/home/sayi/ft/base/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{useState,useEffect}from'react';import Game from'./Game';import socket from'./PongSocket';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var aname=\"a\";var bname=\"b\";var dr=0;var row=[];var Pong=function Pong(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),searching=_useState4[0],setSearching=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),connected=_useState6[0],setConnected=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),matched=_useState8[0],setMatched=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),loada=_useState10[0],setloada=_useState10[1];useEffect(function(){socket.on(\"connect\",function(){console.log(\"connect\");setConnected(true);});socket.on(\"matched\",function(e){//여기부터\naname=e.a;bname=e.b;dr=e.dr;setMatched(true);});socket.on(\"disconnect\",function(){setConnected(false);alert(\"disconnected!\");});socket.on(\"finish\",function(e){var name=e===0?aname:bname;row=[];setSearching(false);setMatched(false);alert(\"\".concat(name,\" win!\"));});socket.on(\"gameList\",function(e){row=[];var _iterator=_createForOfIteratorHelper(e),_step;try{var _loop=function _loop(){var g=_step.value;row.push(/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){socket.emit(\"Observe\",g.id);setSearching(true);},children:g.name}));};for(_iterator.s();!(_step=_iterator.n()).done;){_loop();}}catch(err){_iterator.e(err);}finally{_iterator.f();}if(loada)setloada(false);else setloada(true);});},[loada]);var onChange=function onChange(e){setText(e.target.value);};var onSearch=function onSearch(){if(text==='')alert(\"need nickname!\");else if(connected){socket.emit('Join',text);setSearching(true);console.log(\"join start!\");}else alert(\"not connected!\");};var onGameSearch=function onGameSearch(){if(connected){socket.emit('GameList');}else alert(\"not connected!\");};if(!searching||!connected){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{onChange:onChange,value:text}),/*#__PURE__*/_jsx(\"button\",{onClick:onSearch,children:\"search\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onGameSearch,children:\"show game list\"})]}),/*#__PURE__*/_jsx(\"div\",{children:row})]});}else{return!matched?/*#__PURE__*/_jsx(\"div\",{children:\"Matching ...\"}):/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Game,{a:aname,b:bname,dr:dr})});}};export default Pong;","map":{"version":3,"sources":["/home/sayi/ft/base/client/src/Pong/Pong.tsx"],"names":["React","useState","useEffect","Game","socket","aname","bname","dr","row","Pong","text","setText","searching","setSearching","connected","setConnected","matched","setMatched","loada","setloada","on","console","log","e","a","b","alert","name","g","push","emit","id","onChange","target","value","onSearch","onGameSearch"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useState, useEffect } from 'react';\nimport Game from './Game';\nimport socket from './PongSocket'\n\ninterface MatchData {\n    a: string,\n    b: string,\n    dr: number\n}\n\ninterface GameNode {\n    id: number,\n    name: string\n}\n\nlet aname = \"a\";\nlet bname = \"b\";\nlet dr = 0;\nlet row: JSX.Element[] = [];\n\nconst Pong = () => {\n    const [text, setText] = useState('');\n    const [searching, setSearching] = useState(false);\n    const [connected, setConnected] = useState(false);\n    const [matched, setMatched] = useState(false);\n    const [loada, setloada] = useState(false);\n\n    useEffect(() => {\n        socket.on(\"connect\", () => {\n            console.log(\"connect\");\n            setConnected(true);\n        });\n\n        socket.on(\"matched\", (e: MatchData) => { //여기부터\n            aname = e.a;\n            bname = e.b;\n            dr = e.dr;\n            setMatched(true);\n        });\n\n        socket.on(\"disconnect\", () => {\n            setConnected(false);\n            alert(\"disconnected!\");\n        });\n\n        socket.on(\"finish\", (e: number) => {\n            let name = e === 0 ? aname : bname;\n            row = [];\n            setSearching(false);\n            setMatched(false);\n            alert(`${name} win!`);\n        });\n\n        socket.on(\"gameList\", (e: GameNode[]) => {\n            row = [];\n            for (let g of e) {\n                row.push(<button onClick={() => { socket.emit(\"Observe\", g.id); setSearching(true); }}>{g.name}</button>);\n            }\n            if (loada)\n                setloada(false);\n            else\n                setloada(true);\n        });\n\n    }, [loada]);\n\n\n\n    const onChange = (e: any) => {\n        setText(e.target.value);\n    };\n\n    const onSearch = () => {\n        if (text === '')\n            alert(`need nickname!`);\n        else if (connected) {\n            socket.emit('Join', text);\n            setSearching(true);\n            console.log(\"join start!\");\n        }\n        else\n            alert(`not connected!`);\n    };\n\n    const onGameSearch = () => {\n        if (connected) {\n            socket.emit('GameList');\n        }\n        else\n            alert(`not connected!`);\n    }\n\n    if (!searching || !connected) {\n        return (\n            <div>\n                <div>\n                    <input onChange={onChange} value={text} />\n                    <button onClick={onSearch}>search</button>\n                    <button onClick={onGameSearch}>show game list</button>\n                </div>\n                <div>{row}</div>\n            </div>\n        );\n    }\n    else {\n        return !matched ? (\n            <div>\n                Matching ...\n            </div>\n        ) : (\n            <div>\n                <Game a={aname} b={bname} dr={dr} />\n            </div>\n        );\n    }\n}\n\nexport default Pong;\n"]},"metadata":{},"sourceType":"module"}