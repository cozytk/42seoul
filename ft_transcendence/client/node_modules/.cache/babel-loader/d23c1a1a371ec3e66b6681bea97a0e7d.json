{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/sayi/ft/base/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"/home/sayi/ft/base/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{useState,useEffect}from'react';import Game from'./Game';import{socket}from'./PongSocket';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var aname='a';var bname='b';var dr=0;var row=[];var Pong=function Pong(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),searching=_useState4[0],setSearching=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),connected=_useState6[0],setConnected=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),matched=_useState8[0],setMatched=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),loada=_useState10[0],setloada=_useState10[1];useEffect(function(){socket.on('connect',function(){console.log('connect');setConnected(true);});socket.on('matched',function(e){//여기부터\naname=e.a;bname=e.b;dr=e.dr;setMatched(true);});socket.on('disconnect',function(){setConnected(false);alert('disconnected!');});socket.on('finish',function(e){var name=e===0?aname:bname;row=[];setSearching(false);setMatched(false);alert(\"\".concat(name,\" win!\"));});socket.on('gameList',function(e){row=[];var _iterator=_createForOfIteratorHelper(e),_step;try{var _loop=function _loop(){var g=_step.value;row.push(/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){socket.emit('Observe',g.id);setSearching(true);},children:g.name}));};for(_iterator.s();!(_step=_iterator.n()).done;){_loop();}}catch(err){_iterator.e(err);}finally{_iterator.f();}if(loada)setloada(false);else setloada(true);});},[loada]);var onChange=function onChange(e){setText(e.target.value);};var onSearch=function onSearch(){if(text==='')alert(\"need nickname!\");else if(connected){socket.emit('Join',text);setSearching(true);console.log('join start!');}else alert(\"not connected!\");};var onGameSearch=function onGameSearch(){if(connected){socket.emit('GameList');}else alert(\"not connected!\");};if(!searching||!connected){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{onChange:onChange,value:text}),/*#__PURE__*/_jsx(\"button\",{onClick:onSearch,children:\"search\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onGameSearch,children:\"show game list\"})]}),/*#__PURE__*/_jsx(\"div\",{children:row})]});}else{return!matched?/*#__PURE__*/_jsx(\"div\",{children:\"Matching ...\"}):/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Game,{a:aname,b:bname,dr:dr})});}};export default Pong;","map":{"version":3,"sources":["/home/sayi/ft/base/client/src/Pong/Pong.tsx"],"names":["React","useState","useEffect","Game","socket","aname","bname","dr","row","Pong","text","setText","searching","setSearching","connected","setConnected","matched","setMatched","loada","setloada","on","console","log","e","a","b","alert","name","g","push","emit","id","onChange","target","value","onSearch","onGameSearch"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useState, useEffect } from 'react';\nimport Game from './Game';\nimport { socket } from './PongSocket';\n\ninterface MatchData {\n  a: string;\n  b: string;\n  dr: number;\n}\n\ninterface GameNode {\n  id: number;\n  name: string;\n}\n\nlet aname = 'a';\nlet bname = 'b';\nlet dr = 0;\nlet row: JSX.Element[] = [];\n\nconst Pong = () => {\n  const [text, setText] = useState('');\n  const [searching, setSearching] = useState(false);\n  const [connected, setConnected] = useState(false);\n  const [matched, setMatched] = useState(false);\n  const [loada, setloada] = useState(false);\n\n  useEffect(() => {\n    socket.on('connect', () => {\n      console.log('connect');\n      setConnected(true);\n    });\n\n    socket.on('matched', (e: MatchData) => {\n      //여기부터\n      aname = e.a;\n      bname = e.b;\n      dr = e.dr;\n      setMatched(true);\n    });\n\n    socket.on('disconnect', () => {\n      setConnected(false);\n      alert('disconnected!');\n    });\n\n    socket.on('finish', (e: number) => {\n      let name = e === 0 ? aname : bname;\n      row = [];\n      setSearching(false);\n      setMatched(false);\n      alert(`${name} win!`);\n    });\n\n    socket.on('gameList', (e: GameNode[]) => {\n      row = [];\n      for (let g of e) {\n        row.push(\n          <button\n            onClick={() => {\n              socket.emit('Observe', g.id);\n              setSearching(true);\n            }}\n          >\n            {g.name}\n          </button>,\n        );\n      }\n      if (loada) setloada(false);\n      else setloada(true);\n    });\n  }, [loada]);\n\n  const onChange = (e: any) => {\n    setText(e.target.value);\n  };\n\n  const onSearch = () => {\n    if (text === '') alert(`need nickname!`);\n    else if (connected) {\n      socket.emit('Join', text);\n      setSearching(true);\n      console.log('join start!');\n    } else alert(`not connected!`);\n  };\n\n  const onGameSearch = () => {\n    if (connected) {\n      socket.emit('GameList');\n    } else alert(`not connected!`);\n  };\n\n  if (!searching || !connected) {\n    return (\n      <div>\n        <div>\n          <input onChange={onChange} value={text} />\n          <button onClick={onSearch}>search</button>\n          <button onClick={onGameSearch}>show game list</button>\n        </div>\n        <div>{row}</div>\n      </div>\n    );\n  } else {\n    return !matched ? (\n      <div>Matching ...</div>\n    ) : (\n      <div>\n        <Game a={aname} b={bname} dr={dr} />\n      </div>\n    );\n  }\n};\n\nexport default Pong;\n"]},"metadata":{},"sourceType":"module"}