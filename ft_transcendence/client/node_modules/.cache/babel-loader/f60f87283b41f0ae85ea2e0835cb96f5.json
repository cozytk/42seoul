{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sohndohyun/works/transcendence/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sohndohyun/works/transcendence/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sohndohyun/works/transcendence/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from\"axios\";import React,{useEffect,useState}from\"react\";import'./styles/Auth.scss';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var Auth=function Auth(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),IntraID=_useState2[0],setIntraID=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),AuthCode=_useState4[0],setAuthCode=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),WrongCode=_useState6[0],setWrongCode=_useState6[1];useEffect(function(){var url=window.location.href.split('?');if(url[1]){var intra_id=url[1].split('=');if(intra_id[0]==='intra_id'){setIntraID(intra_id[1]);sessionStorage.setItem('intraID',intra_id[1]);}}});var handleAuthCodeChange=function handleAuthCodeChange(e){setAuthCode(e.target.value);};var authCheck=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.post('/log/2-factor-auth',{intra_id:IntraID,auth_value:AuthCode});case 2:res=_context.sent;if(res.data.auth_result){sessionStorage.setItem('2auth',\"true\");if(res.data.id){sessionStorage.setItem(\"nickname\",res.data.id);document.location.href=\"/lobby\";}else document.location.href=\"/admin\";}else{setWrongCode(true);}case 4:case\"end\":return _context.stop();}}},_callee);}));return function authCheck(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"auth-box\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"auth-comment\",children:[IntraID,\"@student.42seoul.kr\\uB85C \\uBA54\\uC77C\\uC774 \\uBC1C\\uC1A1\\uB418\\uC5C8\\uC2B5\\uB2C8\\uB2E4.\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"\\uC778\\uC99D \\uCF54\\uB4DC\\uB97C \\uC785\\uB825\\uD574\\uC8FC\\uC138\\uC694\",onChange:handleAuthCodeChange}),/*#__PURE__*/_jsx(\"button\",{onClick:authCheck,className:\"auth-btn\",children:\"\\uD655\\uC778\"})]}),WrongCode?/*#__PURE__*/_jsx(\"div\",{className:\"wrong-code\",children:\"\\uC798\\uBABB\\uB41C \\uCF54\\uB4DC\\uC785\\uB2C8\\uB2E4.\"}):null]});};export default Auth;","map":{"version":3,"sources":["/Users/sohndohyun/works/transcendence/client/src/Auth/Auth.tsx"],"names":["axios","React","useEffect","useState","Auth","IntraID","setIntraID","AuthCode","setAuthCode","WrongCode","setWrongCode","url","window","location","href","split","intra_id","sessionStorage","setItem","handleAuthCodeChange","e","target","value","authCheck","post","auth_value","res","data","auth_result","id","document"],"mappings":"seAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAO,oBAAP,C,wFAEA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,EAAM,eAEYD,QAAQ,CAAC,EAAD,CAFpB,wCAEXE,OAFW,eAEFC,UAFE,8BAGcH,QAAQ,CAAC,EAAD,CAHtB,yCAGXI,QAHW,eAGDC,WAHC,8BAIgBL,QAAQ,CAAC,KAAD,CAJxB,yCAIXM,SAJW,eAIAC,YAJA,eAMlBR,SAAS,CAAC,UAAM,CACf,GAAMS,CAAAA,GAAG,CAAGC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqBC,KAArB,CAA2B,GAA3B,CAAZ,CACA,GAAIJ,GAAG,CAAC,CAAD,CAAP,CACA,CACC,GAAMK,CAAAA,QAAQ,CAAGL,GAAG,CAAC,CAAD,CAAH,CAAOI,KAAP,CAAa,GAAb,CAAjB,CACA,GAAIC,QAAQ,CAAC,CAAD,CAAR,GAAgB,UAApB,CACA,CACCV,UAAU,CAACU,QAAQ,CAAC,CAAD,CAAT,CAAV,CACAC,cAAc,CAACC,OAAf,CAAuB,SAAvB,CAAkCF,QAAQ,CAAC,CAAD,CAA1C,EACA,CACD,CACD,CAXQ,CAAT,CAaA,GAAMG,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAACC,CAAD,CAAW,CACvCZ,WAAW,CAACY,CAAC,CAACC,MAAF,CAASC,KAAV,CAAX,CACA,CAFD,CAIA,GAAMC,CAAAA,SAAS,0FAAG,iKACCvB,CAAAA,KAAK,CAACwB,IAAN,CAAW,oBAAX,CAAiC,CAClDR,QAAQ,CAAEX,OADwC,CAElDoB,UAAU,CAAElB,QAFsC,CAAjC,CADD,QACXmB,GADW,eAMjB,GAAIA,GAAG,CAACC,IAAJ,CAASC,WAAb,CACA,CACCX,cAAc,CAACC,OAAf,CAAuB,OAAvB,CAAgC,MAAhC,EACA,GAAIQ,GAAG,CAACC,IAAJ,CAASE,EAAb,CACA,CACCZ,cAAc,CAACC,OAAf,CAAuB,UAAvB,CAAmCQ,GAAG,CAACC,IAAJ,CAASE,EAA5C,EACAC,QAAQ,CAACjB,QAAT,CAAkBC,IAAlB,CAAuB,QAAvB,CACA,CAJD,IAMCgB,CAAAA,QAAQ,CAACjB,QAAT,CAAkBC,IAAlB,CAAuB,QAAvB,CACD,CAVD,IAYA,CACCJ,YAAY,CAAC,IAAD,CAAZ,CACA,CApBgB,sDAAH,kBAATa,CAAAA,SAAS,0CAAf,CAwBA,mBACA,aAAK,SAAS,CAAC,UAAf,wBACC,aAAK,SAAS,CAAC,cAAf,WACElB,OADF,8FADD,cAIC,oCACC,cAAO,WAAW,CAAC,sEAAnB,CAAmC,QAAQ,CAAEc,oBAA7C,EADD,cAEC,eAAQ,OAAO,CAAEI,SAAjB,CAA4B,SAAS,CAAC,UAAtC,0BAFD,GAJD,CAQEd,SAAS,cACT,YAAK,SAAS,CAAC,YAAf,gEADS,CAIP,IAZJ,GADA,CAkBA,CAjED,CAmEA,cAAeL,CAAAA,IAAf","sourcesContent":["import axios from \"axios\";\nimport React, { useEffect, useState } from \"react\";\nimport './styles/Auth.scss'\n\nconst Auth = () => {\n\n\tconst [IntraID, setIntraID] = useState('')\n\tconst [AuthCode, setAuthCode] = useState('')\n\tconst [WrongCode, setWrongCode] = useState(false)\n\n\tuseEffect(() => {\n\t\tconst url = window.location.href.split('?')\n\t\tif (url[1])\n\t\t{\n\t\t\tconst intra_id = url[1].split('=')\n\t\t\tif (intra_id[0] === 'intra_id')\n\t\t\t{\n\t\t\t\tsetIntraID(intra_id[1])\n\t\t\t\tsessionStorage.setItem('intraID', intra_id[1])\n\t\t\t}\n\t\t}\n\t})\n\n\tconst handleAuthCodeChange = (e:any) => {\n\t\tsetAuthCode(e.target.value);\n\t};\n\n\tconst authCheck = async() => {\n\t\tconst res = await axios.post('/log/2-factor-auth', {\n\t\t\tintra_id: IntraID,\n\t\t\tauth_value: AuthCode\n\t\t})\n\n\t\tif (res.data.auth_result)\n\t\t{\n\t\t\tsessionStorage.setItem('2auth', \"true\")\n\t\t\tif (res.data.id)\n\t\t\t{\n\t\t\t\tsessionStorage.setItem(\"nickname\", res.data.id);\n\t\t\t\tdocument.location.href=\"/lobby\"\n\t\t\t}\n\t\t\telse\n\t\t\t\tdocument.location.href=\"/admin\"\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetWrongCode(true)\n\t\t}\n\t}\n\t\n\n\treturn (\n\t<div className=\"auth-box\">\n\t\t<div className=\"auth-comment\">\n\t\t\t{IntraID}@student.42seoul.kr로 메일이 발송되었습니다.\n\t\t</div>\n\t\t<div>\n\t\t\t<input placeholder=\"인증 코드를 입력해주세요\" onChange={handleAuthCodeChange}/>\n\t\t\t<button onClick={authCheck} className=\"auth-btn\">확인</button>\n\t\t</div>\n\t\t{WrongCode ? \n\t\t\t<div className=\"wrong-code\">\n\t\t\t\t잘못된 코드입니다.\n\t\t\t</div>\n\t\t\t: null\n\t\t}\n\t</div>\n\t)\n\n}\n\nexport default Auth"]},"metadata":{},"sourceType":"module"}