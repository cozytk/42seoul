{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jinkim/bye_blackhole/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/jinkim/bye_blackhole/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/jinkim/bye_blackhole/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jinkim/bye_blackhole/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import\"./styles/ChatLog.scss\";import{findImg}from'../Images/Images';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ChatLog=function ChatLog(_ref){var socket=_ref.socket;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),msgList=_useState2[0],setMsgList=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),MyID=_useState4[0],setMyID=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),roomName=_useState6[0],setRoomName=_useState6[1];useEffect(function(){var id=sessionStorage.getItem('nickname');var room=sessionStorage.getItem('roomName');if(id)setMyID(id);if(room)setRoomName(room);socket.on(\"onReceive\",/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(messageItem){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(MyID);if(MyID===messageItem.nickname)setMsgList(function(msgList){return[].concat(_toConsumableArray(msgList),[{myMsg:messageItem.msg,date:messageItem.date}]);});else setMsgList(function(msgList){return[].concat(_toConsumableArray(msgList),[messageItem]);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());/*\n\t\tsocket.on(\"onConnect\", async (systemMessage: string) => {\n\t\t\tsetMsgList((msgList) => [...msgList, { sysMsg: systemMessage } as never]);\n\t\t});\n\t\tsocket.on(\"onDisconnect\", async(systemMessage: any) => {\n\t\t\tsetMsgList((msgList) => [...msgList, { sysMsg: systemMessage } as never]);\n\t\t});\n\t\t*/return function(){socket.disconnect(roomName);};},[socket]);return/*#__PURE__*/_jsx(\"div\",{children:msgList.map(function(msg,idx){return/*#__PURE__*/_jsxs(\"div\",{children:[msg.msg&&/*#__PURE__*/_jsxs(\"div\",{className:\"msgLeft\",children:[/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"img\",{src:findImg(msg.icon),width:\"30\",height:\"30\",className:\"msg-icon\"})}),/*#__PURE__*/_jsxs(\"span\",{children:[msg.nickname&&/*#__PURE__*/_jsx(\"div\",{className:\"msg-userName\",children:msg.nickname}),/*#__PURE__*/_jsx(\"div\",{className:\"msg-left\",children:msg.msg})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"msg-timeStamp\",children:[\"(\",msg.date,\")\"]})]}),msg.myMsg&&/*#__PURE__*/_jsxs(\"div\",{className:\"msgRight\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"msg-right\",children:msg.myMsg}),/*#__PURE__*/_jsxs(\"span\",{className:\"msg-timeStamp\",children:[\"(\",msg.date,\")\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sysMsg\",children:msg.sysMsg})]},idx);})});};export default ChatLog;","map":{"version":3,"sources":["/Users/jinkim/bye_blackhole/client/src/Chat/ChatLog.tsx"],"names":["React","useEffect","useState","findImg","ChatLog","socket","msgList","setMsgList","MyID","setMyID","roomName","setRoomName","id","sessionStorage","getItem","room","on","messageItem","console","log","nickname","myMsg","msg","date","disconnect","map","idx","icon","sysMsg"],"mappings":"ymBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAO,uBAAP,CACA,OAAQC,OAAR,KAAsB,kBAAtB,C,wFAGA,GAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,MAAmB,IAAjBC,CAAAA,MAAiB,MAAjBA,MAAiB,eACJH,QAAQ,CAAQ,EAAR,CADJ,wCAC3BI,OAD2B,eAClBC,UADkB,8BAEVL,QAAQ,CAAC,EAAD,CAFE,yCAE3BM,IAF2B,eAErBC,OAFqB,8BAGFP,QAAQ,CAAC,EAAD,CAHN,yCAG3BQ,QAH2B,eAGjBC,WAHiB,eAKlCV,SAAS,CAAC,UAAM,CACf,GAAMW,CAAAA,EAAE,CAAGC,cAAc,CAACC,OAAf,CAAuB,UAAvB,CAAX,CACA,GAAMC,CAAAA,IAAI,CAAGF,cAAc,CAACC,OAAf,CAAuB,UAAvB,CAAb,CACA,GAAIF,EAAJ,CAAQH,OAAO,CAACG,EAAD,CAAP,CACR,GAAIG,IAAJ,CAAUJ,WAAW,CAACI,IAAD,CAAX,CAEVV,MAAM,CAACW,EAAP,CAAU,WAAV,2FAAuB,iBAAMC,WAAN,kHACtBC,OAAO,CAACC,GAAR,CAAYX,IAAZ,EACA,GAAIA,IAAI,GAAKS,WAAW,CAACG,QAAzB,CACCb,UAAU,CAAC,SAACD,OAAD,qCAAiBA,OAAjB,GAA0B,CAACe,KAAK,CAAEJ,WAAW,CAACK,GAApB,CAAyBC,IAAI,CAAEN,WAAW,CAACM,IAA3C,CAA1B,IAAD,CAAV,CADD,IAGChB,CAAAA,UAAU,CAAC,SAACD,OAAD,qCAAiBA,OAAjB,GAA0BW,WAA1B,IAAD,CAAV,CALqB,sDAAvB,iEAOA;AACF;AACA;AACA;AACA;AACA;AACA;AACA,IACE,MAAO,WAAM,CACZZ,MAAM,CAACmB,UAAP,CAAkBd,QAAlB,EACA,CAFD,CAGA,CAxBQ,CAwBN,CAACL,MAAD,CAxBM,CAAT,CA0BA,mBACA,qBACEC,OAAO,CAACmB,GAAR,CAAY,SAACH,GAAD,CAAMI,GAAN,qBACb,uBACEJ,GAAG,CAACA,GAAJ,eACA,aAAK,SAAS,CAAC,SAAf,wBACC,mCAAM,YAAK,GAAG,CAAEnB,OAAO,CAACmB,GAAG,CAACK,IAAL,CAAjB,CAA8B,KAAK,CAAC,IAApC,CAAyC,MAAM,CAAC,IAAhD,CAAqD,SAAS,CAAC,UAA/D,EAAN,EADD,cAEC,wBACEL,GAAG,CAACF,QAAJ,eAAgB,YAAK,SAAS,CAAC,cAAf,UAA+BE,GAAG,CAACF,QAAnC,EADlB,cAEC,YAAK,SAAS,CAAC,UAAf,UAA2BE,GAAG,CAACA,GAA/B,EAFD,GAFD,cAMC,cAAM,SAAS,CAAC,eAAhB,eAAkCA,GAAG,CAACC,IAAtC,OAND,GAFF,CAWED,GAAG,CAACD,KAAJ,eACA,aAAK,SAAS,CAAC,UAAf,wBACC,aAAM,SAAS,CAAC,WAAhB,UAA6BC,GAAG,CAACD,KAAjC,EADD,cAEC,cAAM,SAAS,CAAC,eAAhB,eAAkCC,GAAG,CAACC,IAAtC,OAFD,GAZF,cAiBC,YAAK,SAAS,CAAC,QAAf,UAA0BD,GAAG,CAACM,MAA9B,EAjBD,GAAUF,GAAV,CADa,EAAZ,CADF,EADA,CAyBA,CAxDD,CA0DA,cAAetB,CAAAA,OAAf","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport \"./styles/ChatLog.scss\";\nimport {findImg} from '../Images/Images'\nimport axios from \"axios\";\n\nconst ChatLog = ({socket}: any) => {\n\tconst [msgList, setMsgList] = useState<any[]>([])\n\tconst [MyID, setMyID] = useState('')\n\tconst [roomName, setRoomName] = useState('')\n\n\tuseEffect(() => {\n\t\tconst id = sessionStorage.getItem('nickname')\n\t\tconst room = sessionStorage.getItem('roomName')\n\t\tif (id) setMyID(id)\n\t\tif (room) setRoomName(room)\n\n\t\tsocket.on(\"onReceive\", async(messageItem: {nickname:string, msg:string, date:string, icon:string}) => {\n\t\t\tconsole.log(MyID)\n\t\t\tif (MyID === messageItem.nickname)\n\t\t\t\tsetMsgList((msgList) => [...msgList, {myMsg: messageItem.msg, date: messageItem.date} as never]);\n\t\t\telse\n\t\t\t\tsetMsgList((msgList) => [...msgList, messageItem]);\n\t\t});\n\t\t/*\n\t\tsocket.on(\"onConnect\", async (systemMessage: string) => {\n\t\t\tsetMsgList((msgList) => [...msgList, { sysMsg: systemMessage } as never]);\n\t\t});\n\t\tsocket.on(\"onDisconnect\", async(systemMessage: any) => {\n\t\t\tsetMsgList((msgList) => [...msgList, { sysMsg: systemMessage } as never]);\n\t\t});\n\t\t*/\n\t\treturn () => {\n\t\t\tsocket.disconnect(roomName);\n\t\t};\n\t}, [socket]);\n\n\treturn (\n\t<div>\n\t\t{msgList.map((msg, idx) => (\n\t\t<div key={idx}>\n\t\t\t{msg.msg &&\n\t\t\t\t<div className=\"msgLeft\">\n\t\t\t\t\t<span><img src={findImg(msg.icon)}  width=\"30\" height=\"30\" className=\"msg-icon\"/></span>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{msg.nickname && <div className=\"msg-userName\">{msg.nickname}</div>}\n\t\t\t\t\t\t<div className=\"msg-left\">{msg.msg}</div>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span className=\"msg-timeStamp\">({msg.date})</span>\n\t\t\t\t</div>\n\t\t\t}\n\t\t\t{msg.myMsg &&\n\t\t\t\t<div className=\"msgRight\">\n\t\t\t\t\t<span className=\"msg-right\">{msg.myMsg}</span>\n\t\t\t\t\t<span className=\"msg-timeStamp\">({msg.date})</span>\n\t\t\t\t</div>\n\t\t\t}\n\t\t\t<div className=\"sysMsg\" >{msg.sysMsg}</div>\n\t\t</div>\n\t\t))}\n\t</div>\n\t);\n};\n\nexport default ChatLog;"]},"metadata":{},"sourceType":"module"}