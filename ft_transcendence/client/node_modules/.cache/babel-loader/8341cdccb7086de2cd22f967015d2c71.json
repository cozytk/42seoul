{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jinkim/2bye/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jinkim/2bye/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jinkim/2bye/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import\"./styles/ChatInput.css\";import'bootstrap/dist/css/bootstrap.min.css';import{Button}from\"react-bootstrap\";import useSwr from'swr';import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ChatInput=function ChatInput(_ref){var socket=_ref.socket;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),chatMessage=_useState2[0],setChatMessage=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),MyID=_useState4[0],setMyID=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),roomName=_useState6[0],setRoomName=_useState6[1];var fetcher=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(url){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!roomName){_context.next=5;break;}_context.next=3;return axios.get(url);case 3:res=_context.sent;return _context.abrupt(\"return\",res.data);case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetcher(_x){return _ref2.apply(this,arguments);};}();var _useSwr=useSwr('/chat/chatLog?title='+roomName,fetcher),data=_useSwr.data,error=_useSwr.error,mutate=_useSwr.mutate;useEffect(function(){var id=sessionStorage.getItem('nickname');var room=sessionStorage.getItem('roomName');if(id)setMyID(id);if(room)setRoomName(room);});var handleSubmit=function handleSubmit(e){e.preventDefault();socket.emit(\"onSend\",{title:roomName,nickname:MyID,msg:chatMessage,date:new Date().toLocaleTimeString()});setChatMessage(\"\");mutate();};var onChatMessageChange=function onChatMessageChange(e){setChatMessage(e.target.value);};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"form\",{className:\"ChatInput-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Enter message\",value:chatMessage,onChange:onChatMessageChange}),/*#__PURE__*/_jsx(Button,{type:\"button\",className:\"btn btn-sm\",onClick:handleSubmit,children:\"send\"})]})});};export default ChatInput;","map":{"version":3,"sources":["/Users/jinkim/2bye/client/src/Chat/ChatInput.tsx"],"names":["React","useEffect","useState","Button","useSwr","axios","ChatInput","socket","chatMessage","setChatMessage","MyID","setMyID","roomName","setRoomName","fetcher","url","get","res","data","error","mutate","id","sessionStorage","getItem","room","handleSubmit","e","preventDefault","emit","title","nickname","msg","date","Date","toLocaleTimeString","onChatMessageChange","target","value"],"mappings":"6aAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAAmCC,QAAnC,KAAmD,OAAnD,CACA,MAAO,wBAAP,CACA,MAAO,sCAAP,CACA,OAAQC,MAAR,KAAqB,iBAArB,CACA,MAAOC,CAAAA,MAAP,KAAmB,KAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,C,wFAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,MAAmB,IAAjBC,CAAAA,MAAiB,MAAjBA,MAAiB,eACEL,QAAQ,CAAC,EAAD,CADV,wCAC7BM,WAD6B,eAChBC,cADgB,8BAEZP,QAAQ,CAAC,EAAD,CAFI,yCAE7BQ,IAF6B,eAEvBC,OAFuB,8BAGJT,QAAQ,CAAC,EAAD,CAHJ,yCAG7BU,QAH6B,eAGnBC,WAHmB,eAKpC,GAAMC,CAAAA,OAAO,2FAAG,iBAAOC,GAAP,8HACXH,QADW,+CAGIP,CAAAA,KAAK,CAACW,GAAN,CAAUD,GAAV,CAHJ,QAGRE,GAHQ,+CAIPA,GAAG,CAACC,IAJG,wDAAH,kBAAPJ,CAAAA,OAAO,6CAAb,CALoC,YAYNV,MAAM,CAAwD,uBAAyBQ,QAAjF,CAA2FE,OAA3F,CAZA,CAY7BI,IAZ6B,SAY7BA,IAZ6B,CAYvBC,KAZuB,SAYvBA,KAZuB,CAYhBC,MAZgB,SAYhBA,MAZgB,CAcpCnB,SAAS,CAAC,UAAM,CACf,GAAMoB,CAAAA,EAAE,CAAGC,cAAc,CAACC,OAAf,CAAuB,UAAvB,CAAX,CACA,GAAMC,CAAAA,IAAI,CAAGF,cAAc,CAACC,OAAf,CAAuB,UAAvB,CAAb,CACA,GAAIF,EAAJ,CAAQV,OAAO,CAACU,EAAD,CAAP,CACR,GAAIG,IAAJ,CAAUX,WAAW,CAACW,IAAD,CAAX,CACV,CALQ,CAAT,CAOA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,CAAD,CAAW,CAC/BA,CAAC,CAACC,cAAF,GACApB,MAAM,CAACqB,IAAP,CAAY,QAAZ,CAAsB,CACrBC,KAAK,CAAEjB,QADc,CAErBkB,QAAQ,CAAEpB,IAFW,CAGrBqB,GAAG,CAAEvB,WAHgB,CAIrBwB,IAAI,CAAE,GAAIC,CAAAA,IAAJ,GAAWC,kBAAX,EAJe,CAAtB,EAMAzB,cAAc,CAAC,EAAD,CAAd,CACAW,MAAM,GACN,CAVD,CAYC,GAAMe,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,CAACT,CAAD,CAAW,CACrCjB,cAAc,CAACiB,CAAC,CAACU,MAAF,CAASC,KAAV,CAAd,CACD,CAFD,CAIA,mBACE,kCACE,cAAM,SAAS,CAAC,gBAAhB,CAAiC,QAAQ,CAAEZ,YAA3C,wBACE,cAAO,IAAI,CAAC,MAAZ,CAAmB,SAAS,CAAC,cAA7B,CACE,WAAW,CAAC,eADd,CAEE,KAAK,CAAEjB,WAFT,CAGE,QAAQ,CAAE2B,mBAHZ,EADF,cAME,KAAC,MAAD,EAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,YAAhC,CAA6C,OAAO,CAAEV,YAAtD,kBANF,GADF,EADF,CAYD,CAjDD,CAmDA,cAAenB,CAAAA,SAAf","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport \"./styles/ChatInput.css\";\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport {Button} from \"react-bootstrap\";\nimport useSwr from 'swr';\nimport axios from \"axios\";\n\nconst ChatInput = ({socket}: any) => {\n\tconst [chatMessage, setChatMessage] = useState(\"\");\n\tconst [MyID, setMyID] = useState('')\n\tconst [roomName, setRoomName] = useState('')\n\n\tconst fetcher = async (url:string) => {\n\t\tif (roomName)\n\t\t{\n\t\t\tconst res = await axios.get(url)\n\t\t\treturn res.data;\n\t\t}\n\t}\n\tconst {data, error, mutate} = useSwr<{id:string, date:Date, content:string, icon:string}[]>('/chat/chatLog?title=' + roomName, fetcher)\n\n\tuseEffect(() => {\n\t\tconst id = sessionStorage.getItem('nickname')\n\t\tconst room = sessionStorage.getItem('roomName')\n\t\tif (id) setMyID(id)\n\t\tif (room) setRoomName(room)\n\t})\n\n\tconst handleSubmit = (e:any) => {\n\t\te.preventDefault();\n\t\tsocket.emit(\"onSend\", {\n\t\t\ttitle: roomName,\n\t\t\tnickname: MyID,\n\t\t\tmsg: chatMessage,\n\t\t\tdate: new Date().toLocaleTimeString(),\n\t\t});\n\t\tsetChatMessage(\"\");\n\t\tmutate()\n\t};\n\n  const onChatMessageChange = (e:any) => {\n    setChatMessage(e.target.value);\n  };\n\n  return (\n    <div>\n      <form className=\"ChatInput-form\" onSubmit={handleSubmit}>\n        <input type=\"text\" className=\"form-control\"\n          placeholder=\"Enter message\"\n          value={chatMessage}\n          onChange={onChatMessageChange}\n        ></input>\n        <Button type=\"button\" className=\"btn btn-sm\" onClick={handleSubmit}>send</Button>\n      </form>\n    </div>\n  );\n};\n\nexport default ChatInput;"]},"metadata":{},"sourceType":"module"}