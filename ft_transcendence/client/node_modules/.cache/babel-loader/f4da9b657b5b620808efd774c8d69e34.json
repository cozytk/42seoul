{"ast":null,"code":"import _classCallCheck from\"/home/sayi/ft/base/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/sayi/ft/base/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/sayi/ft/base/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/sayi/ft/base/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/sayi/ft/base/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import Canvas from'./Canvas';import Ball from'./Ball';import Wall from'./Wall';import Player from'./Player';import GameObject from'./GameObject';import socket from'./PongSocket';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Game=/*#__PURE__*/function(_React$Component){_inherits(Game,_React$Component);var _super=_createSuper(Game);function Game(props){var _this;_classCallCheck(this,Game);_this=_super.call(this,props);_this.objs=void 0;_this.width=void 0;_this.height=void 0;_this.aname=void 0;_this.bname=void 0;_this.ball=void 0;_this.playerL=void 0;_this.playerR=void 0;_this.ballSpeed=void 0;_this.pos=void 0;_this.objs=[];_this.width=800;_this.height=450;_this.ball=new Ball(_assertThisInitialized(_this),20,20,_this.width/2,_this.height/2);_this.playerL=new Player(_assertThisInitialized(_this),20,_this.height/4,0,_this.height/5*2);_this.playerR=new Player(_assertThisInitialized(_this),20,_this.height/4,_this.width-20,_this.height/5*2);_this.ballSpeed=600;_this.state={SL:0,SR:0};_this.pos=_this.props.dr;_this.aname=_this.props.a;_this.bname=_this.props.b;_this.objs.push(_this.playerL);_this.objs.push(_this.playerR);_this.objs.push(new Wall(_assertThisInitialized(_this),_this.width,20,0,0));_this.objs.push(new Wall(_assertThisInitialized(_this),_this.width,20,0,_this.height-20));_this.objs.push(new GameObject(_assertThisInitialized(_this),10,_this.height,_this.width/2-5,0));_this.objs.push(_this.ball);return _this;}_createClass(Game,[{key:\"receivedMessage\",value:function receivedMessage(message){console.log(message);}},{key:\"draw\",value:function draw(ctx,dt){ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);for(var i=0;i<this.objs.length;i++){this.objs[i].draw(ctx,dt);}}},{key:\"onKeyDown\",value:function onKeyDown(e){if(this.pos>=2)return;var mypl=this.pos===0?this.playerL:this.playerR;if(e.keyCode===40&&mypl.dirY!==1){socket.emit('Down',mypl.y);}else if(e.keyCode===38&&mypl.dirY!==-1){socket.emit('Up',mypl.y);}}},{key:\"onKeyUp\",value:function onKeyUp(e){if(this.pos>=2)return;var mypl=this.pos===0?this.playerL:this.playerR;if(e.keyCode===40||e.keyCode===38){socket.emit('Stop',mypl.y);}}},{key:\"onUp\",value:function onUp(e){if(e.who===0){this.playerL.dirY=-1;this.playerL.y=e.y;}else if(e.who===1){this.playerR.dirY=-1;this.playerR.y=e.y;}}},{key:\"onDown\",value:function onDown(e){if(e.who===0){this.playerL.dirY=1;this.playerL.y=e.y;}else if(e.who===1){this.playerR.dirY=1;this.playerR.y=e.y;}}},{key:\"onStop\",value:function onStop(e){if(e.who===0){this.playerL.dirY=0;this.playerL.y=e.y;}else if(e.who===1){this.playerR.dirY=0;this.playerR.y=e.y;}}},{key:\"onScored\",value:function onScored(e){this.setState(function(){return{SL:e.scoreL,SR:e.scoreR};});this.ball.start(this.ballSpeed,e.dirX,e.dirY);this.playerL.x=0;this.playerL.y=this.height/5*2;this.playerR.x=this.width-20;this.playerR.y=this.height/5*2;}},{key:\"onUpdate\",value:function onUpdate(e){this.ball.onUpdate(e);}},{key:\"onScoredL\",value:function onScoredL(){if(this.pos===0){socket.emit('Scored',0);}}},{key:\"onScoredR\",value:function onScoredR(){if(this.pos===0){socket.emit('Scored',1);}}},{key:\"render\",value:function render(){var _this$state=this.state,SL=_this$state.SL,SR=_this$state.SR;var str=\"\".concat(this.aname,\" \").concat(SL,\" : \").concat(SR,\" \").concat(this.bname);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:str}),/*#__PURE__*/_jsx(Canvas,{game:this})]});}}]);return Game;}(React.Component);export default Game;","map":{"version":3,"sources":["/home/sayi/ft/base/client/src/Pong/Game.tsx"],"names":["React","Canvas","Ball","Wall","Player","GameObject","socket","Game","props","objs","width","height","aname","bname","ball","playerL","playerR","ballSpeed","pos","state","SL","SR","dr","a","b","push","message","console","log","ctx","dt","clearRect","canvas","i","length","draw","e","mypl","keyCode","dirY","emit","y","who","setState","scoreL","scoreR","start","dirX","x","onUpdate","str","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Canvas from './Canvas';\nimport Ball from './Ball';\nimport Wall from './Wall';\nimport Player from './Player';\nimport GameObject from './GameObject';\nimport socket from './PongSocket';\n\nexport interface Scored {\n    scoreL: number,\n    scoreR: number,\n    dirX: number,\n    dirY: number\n}\n\nexport interface Update {\n    x: number,\n    y: number,\n    dirX: number,\n    dirY: number,\n    speed: number\n}\n\nexport interface Moved {\n    who: number,\n    y: number\n}\n\nclass Game extends React.Component<any, any> {\n    objs: GameObject[];\n    width: number;\n    height: number;\n\n    aname: string;\n    bname: string;\n\n    ball: Ball;\n    playerL: Player;\n    playerR: Player;\n    ballSpeed: number;\n    pos: number;\n\n    constructor(props: {}) {\n        super(props);\n        this.objs = [];\n        this.width = 800;\n        this.height = 450;\n        this.ball = new Ball(this, 20, 20, this.width / 2, this.height / 2);\n        this.playerL = new Player(this, 20, this.height / 4, 0, this.height / 5 * 2);\n        this.playerR = new Player(this, 20, this.height / 4, this.width - 20, this.height / 5 * 2);\n        this.ballSpeed = 600;\n\n        this.state = {\n            SL: 0,\n            SR: 0\n        };\n        this.pos = this.props.dr;\n        this.aname = this.props.a;\n        this.bname = this.props.b;\n\n        this.objs.push(this.playerL);\n        this.objs.push(this.playerR);\n        this.objs.push(new Wall(this, this.width, 20, 0, 0));\n        this.objs.push(new Wall(this, this.width, 20, 0, this.height - 20));\n        this.objs.push(new GameObject(this, 10, this.height, this.width / 2 - 5, 0));\n        this.objs.push(this.ball);\n    }\n\n    receivedMessage(message: string) {\n        console.log(message);\n    }\n\n    draw(ctx: any, dt: number) {\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n\n        for (let i = 0; i < this.objs.length; i++)\n            this.objs[i].draw(ctx, dt);\n    }\n\n    onKeyDown(e: KeyboardEvent) {\n        if (this.pos >= 2)\n            return;\n\n        let mypl = this.pos === 0 ? this.playerL : this.playerR;\n        if (e.keyCode === 40 && mypl.dirY !== 1) {\n            socket.emit('Down', mypl.y);\n        }\n        else if (e.keyCode === 38 && mypl.dirY !== -1) {\n            socket.emit('Up', mypl.y);\n        }\n    }\n\n    onKeyUp(e: KeyboardEvent) {\n        if (this.pos >= 2)\n            return;\n\n        let mypl = this.pos === 0 ? this.playerL : this.playerR;\n        if (e.keyCode === 40 || e.keyCode === 38) {\n            socket.emit('Stop', mypl.y);\n        }\n    }\n\n    onUp(e: Moved) {\n        if (e.who === 0) {\n            this.playerL.dirY = -1;\n            this.playerL.y = e.y;\n        }\n        else if (e.who === 1) {\n            this.playerR.dirY = -1;\n            this.playerR.y = e.y;\n        }\n    }\n\n    onDown(e: Moved) {\n        if (e.who === 0) {\n            this.playerL.dirY = 1;\n            this.playerL.y = e.y;\n        }\n        else if (e.who === 1) {\n            this.playerR.dirY = 1;\n            this.playerR.y = e.y;\n        }\n    }\n\n    onStop(e: Moved) {\n        if (e.who === 0) {\n            this.playerL.dirY = 0;\n            this.playerL.y = e.y;\n        }\n        else if (e.who === 1) {\n            this.playerR.dirY = 0;\n            this.playerR.y = e.y;\n        }\n    }\n\n    onScored(e: Scored) {\n        this.setState(() => { return { SL: e.scoreL, SR: e.scoreR }; });\n\n        this.ball.start(this.ballSpeed, e.dirX, e.dirY);\n\n        this.playerL.x = 0;\n        this.playerL.y = this.height / 5 * 2;\n        this.playerR.x = this.width - 20;\n        this.playerR.y = this.height / 5 * 2;\n    }\n\n    onUpdate(e: Update) {\n        this.ball.onUpdate(e);\n    }\n\n    onScoredL() {\n        if (this.pos === 0) {\n            socket.emit('Scored', 0);\n        }\n    }\n\n    onScoredR() {\n        if (this.pos === 0) {\n            socket.emit('Scored', 1);\n        }\n    }\n\n    render() {\n        const { SL, SR } = this.state;\n\n        let str = `${this.aname} ${SL} : ${SR} ${this.bname}`;\n\n        return (\n            <div>\n                <h1>{str}</h1>\n                <Canvas game={this} />\n            </div>\n        );\n    }\n}\n\nexport default Game;\n"]},"metadata":{},"sourceType":"module"}